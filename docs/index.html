<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Saskatchewan's source for data analytics.">
    <title>Open Data Saskatchewan</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            font-family: 'Inter', sans-serif;
            background: #f9fafb;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }
        header {
            text-align: center;
            margin-bottom: 2rem;
        }
        header h1 {
            font-size: 2.5rem;
            font-weight: 600;
            color: #2c3e50;
        }
        header p {
            font-size: 1rem;
            color: #7f8c8d;
        }
        .intro-card {
            background: white;
            border: 1px solid #e1e4e8;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            text-align: center;
            margin-bottom: 2rem;
            max-width: 800px;
        }
        .intro-card p {
            font-size: 1rem;
            color: #7f8c8d;
            line-height: 1.5;
        }
        .plans {
            display: flex;
            gap: 2rem;
            justify-content: center;
            margin-top: 2rem;
        }
        .plan {
            background: white;
            border: 1px solid #e1e4e8;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            width: 300px;
            text-align: center;
        }
        .plan h2 {
            font-size: 1.5rem;
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }
        .plan .price {
            font-size: 1.25rem;
            font-weight: 600;
            color: #3498db;
            margin-bottom: 1rem;
        }
        .plan p {
            font-size: 0.875rem;
            color: #7f8c8d;
            margin-bottom: 1.5rem;
        }
        .features {
            list-style: none;
            padding: 0;
            margin: 0;
            margin-bottom: 1.5rem;
        }
        .features li {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }
        .features li .icon {
            font-size: 1rem;
        }
        .features li.check {
            color: #27ae60;
        }
        .features li.x {
            color: #e74c3c;
        }
        .plan button {
            background: #3498db;
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .plan button:hover {
            background: #2980b9;
        }
        /* Modal background overlay */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        /* Hide the modal when not active */
        .hidden {
            display: none;
        }

        /* Modal content */
        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            width: 300px;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        /* Input field */
        #email-input {
            width: 100%;
            padding: 0.5rem;
            margin: 1rem 0;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 1rem;
        }

        /* Buttons */
        .modal-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        .modal-actions button {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            cursor: pointer;
        }

        #modal-submit {
            background: #3498db;
            color: white;
        }

        #modal-cancel {
            background: #e74c3c;
            color: white;
        }

        #modal-submit:disabled, #modal-cancel:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }

        #modal-submit:hover {
            background: #2980b9;
        }

        #modal-cancel:hover {
            background: #c0392b;
        }
    </style>
</head>
<body>
    <header>
        <h1>Open Data Saskatchewan</h1>
        <p>Saskatchewan's platform for exclusive insights and data analysis.</p>
    </header>

    <!-- Intro Card -->
    <div class="intro-card">
        <p>Open Data Saskatchewan provides exclusive insights, open data access, and detailed analytics tailored to the needs of our province. By signing up, you'll gain access to valuable content, data, and tools that help you stay informed and make better decisions.</p>
    </div>

    <!-- Handbook card -->
    <div class="intro-card">
        <p>The open data handbook is great!</p>
    </div>

    <div class="plans">
        <div class="plan">
            <h2>Basic</h2>
            <p class="price">Free</p>
            <p>Get started with our free subscription and get immediate access to:</p>
            <ul class="features">
                <li class="check"><span class="icon">✔</span> Data by Andy newsletter</li>
                <li class="check"><span class="icon">✔</span> Sask Open Data Handbook (Instant download)</li>
                <li class="x"><span class="icon">✘</span> Premium analytics content</li>
                <li class="x"><span class="icon">✘</span> Sask Economic Trends Quarterly</li>
            </ul>
            <button onclick="showModal('free')">Sign Up for Free</button>
        </div>
        <div class="plan">
            <h2>Professional</h2>
            <p class="price">$20/month</p>
            <p>Immediate access to everything in the free tier, plus unlock these premium features.</p>
            <ul class="features">
                <li class="check"><span class="icon">✔</span> Everything in the free tier</li>
                <li class="check"><span class="icon">✔</span> Premium analytics content</li>
                <li class="check"><span class="icon">✔</span> Mastering Open Data in Saskatchewan - a 5 part course</li>
                <li class="check"><span class="icon">✔</span> Sask Economic Trends Quarterly</li>
            </ul>
            <button onclick="showModal('pro')">Join the Waitlist</button>
        </div>
    </div>

    <!-- Modal -->
    <div id="email-modal" class="modal hidden">
        <div class="modal-content">
            <p id="modal-message">Please input your email address to continue:</p>
            <input id="email-input" type="email" placeholder="Enter your email" required>
            <div class="modal-actions">
                <button id="modal-submit">Submit</button>
                <button id="modal-cancel">Cancel</button>
            </div>
        </div>
    </div>

    <footer>
        <p>&copy; 2024 Open Data Saskatchewan. Built with love. <a href="https://github.com/andrewjdyck/SaskOpenData.github.io">Hosted on GitHub Pages</a>.</p>
    </footer>

    <script>
        const modal = document.getElementById('email-modal');
        const modalMessage = document.getElementById('modal-message');
        const emailInput = document.getElementById('email-input');
        const submitButton = document.getElementById('modal-submit');
        const cancelButton = document.getElementById('modal-cancel');

        let currentPlanType = ''; // Track which plan type is selected

        // Function to show the modal
        function showModal(planType) {
            currentPlanType = planType; // Save the selected plan type
            emailInput.value = ''; // Clear the input
            modalMessage.textContent = 'Please input your email address to continue:';
            submitButton.disabled = false;
            cancelButton.disabled = false;
            modal.classList.remove('hidden');
        }

        // Function to hide the modal
        function hideModal() {
            modal.classList.add('hidden');
        }

        // Function to show the final "Ok" button after response
        function showOkButton() {
            const okButton = document.createElement('button');
            okButton.textContent = 'Ok';
            okButton.style.background = '#3498db';
            okButton.style.color = 'white';
            okButton.style.padding = '0.5rem 1rem';
            okButton.style.border = 'none';
            okButton.style.borderRadius = '4px';
            okButton.style.cursor = 'pointer';
            okButton.addEventListener('click', hideModal);

            const actions = document.querySelector('.modal-actions');
            actions.innerHTML = ''; // Clear existing buttons
            actions.appendChild(okButton);
        }

        // Submit button click handler
        submitButton.addEventListener('click', async () => {
            const email = emailInput.value.trim();
            if (!email) {
                modalMessage.textContent = 'Email is required!';
                return;
            }

            submitButton.disabled = true;
            cancelButton.disabled = true;

            try {
                const response = await fetch('https://y77lgjrk65wuug7mykwoupug7m0upgiq.lambda-url.us-west-2.on.aws/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ email, planType: currentPlanType }),
                });

                const result = await response.json();

                if (response.ok) {
                    modalMessage.textContent = 'Successfully subscribed! Check your inbox for confirmation.';
                    showOkButton();
                } else {
                    modalMessage.textContent = `Error: ${result.message}`;
                    submitButton.disabled = false;
                    cancelButton.disabled = false;
                }
            } catch (error) {
                modalMessage.textContent = 'An error occurred. Please try again.';
                console.error('Error subscribing:', error);
                submitButton.disabled = false;
                cancelButton.disabled = false;
            }
        });

        // Cancel button click handler
        cancelButton.addEventListener('click', hideModal);
    </script>
</body>
</html>
